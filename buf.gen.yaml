version: v2
managed:
  enabled: true
  override:
    - file_option: go_package_prefix
      value: kratos-kratos-admin/api/gen/go
    - file_option: go_package
      value: kratos-kratos-admin/api/gen/go/v1;v1
  disable:
    - module: 'buf.build/bufbuild/protovalidate'
    - module: 'buf.build/googleapis/googleapis'
    - module: 'buf.build/kratos/apis'
    - module: 'buf.build/gnostic/gnostic'
plugins:
  # 使用go插件生成go代码
  - remote: buf.build/protocolbuffers/go
    #- local: protoc-gen-go
    out: api/gen/go
    opt:
      - paths=source_relative # 使用相对路径

  # 使用go-grpc插件生成gRPC服务代码
  # - local: protoc-gen-go-grpc
  - remote: buf.build/grpc/go:v1.5.1
    out: api/gen/go
    opt:
      - paths=source_relative # 使用相对路径

  # generate kratos http serve
  - local: protoc-gen-go-http
    out: api/gen/go
    opt:
      - paths=source_relative # 使用相对路径

  # generate kratos errors code
  - local: protoc-gen-go-errors
    out: api/gen/go
    opt:
      - paths=source_relative # 使用相对路径

  # generate protovalidate
  - remote: buf.build/bufbuild/validate-go:v1.2.1
    out: api/gen/go
    opt:
      - paths=source_relative # 使用相对路径

  - local: protoc-gen-openapi
    out: api/gen/openapi
    opt:
      - paths=source_relative

inputs:
  - directory: api/proto